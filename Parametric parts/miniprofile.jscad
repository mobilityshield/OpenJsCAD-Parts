// Mobility Shield Builder ( mobilityshield.com )
// Mini Profile 15 x 15 Generator by J.Rodrigo ( jrodrigo.net )
// Licence: Creative Commons â€” Attribution and Share Alike 

// Global variables
var extrusionlength,Dhole,quality;
var w = new Array();

// Editable parameters
function getParameterDefinitions() {
  return [
	{ name: 'extrusionlength', caption: '<b>Length (mm):</b>', type: 'float', initial: 15 },
	{ name: 'Dhole', caption: '<i>Hole diameter (mm):</i>', type: 'float', initial: 3.9 },
	{ name: 'quality', type: 'choice',
      values: ["8","16","32"],
      captions: ["Low","Medium", "High"],
      caption: '<i>Quality:</i>',
      initial: "16" }
  ];
}

function main(params) {
	
	extrusionlength = params.extrusionlength;	
	Dhole = params.Dhole; 
	quality = params.quality;

	// Profile Polygon Points
	var profile = CAG.fromPoints([ [-6.540062,7.389332],[-6.951151,7.161583],[-7.24005,6.864808],[-7.38901,6.610952],[-7.466097,6.244339],[-7.499356,4.199382],[-7.499356,2.105746],[-7.257179,1.866578],[-7.015002,1.627409],[-6.661073,1.627409],[-6.307144,1.627409],[-6.307144,2.289021],[-6.293184,2.83641],[-6.235088,3.02269],[-6.15565,3.060009],[-5.965249,3.081883],[-4.983089,3.094747],[-3.803148,3.094747],[-3.664188,2.94572],[-3.182608,2.365179],[-2.86994,1.892051],[-2.61538,0.850147],[-2.44637,0.004104],[-2.617896,-0.869389],[-2.844683,-1.880776],[-3.259551,-2.472709],[-3.730877,-3.038266],[-4.156004,-3.083786],[-4.999176,-3.099597],[-5.838508,-3.085315],[-6.252119,-3.040557],[-6.293822,-2.834544],[-6.307144,-2.306889],[-6.307144,-1.628245],[-6.664082,-1.628245],[-7.021019,-1.628245],[-7.260188,-1.870422],[-7.499356,-2.112599],[-7.499356,-4.207271],[-7.485908,-6.052648],[-7.45645,-6.375114],[-7.400596,-6.565905],[-7.264318,-6.82757],[-7.067722,-7.065961],[-6.829331,-7.262557],[-6.567665,-7.398835],[-6.376829,-7.454693],[-6.054052,-7.48415],[-4.206023,-7.497596],[-2.108343,-7.497596],[-1.869174,-7.255419],[-1.630006,-7.013242],[-1.630006,-6.659313],[-1.630006,-6.305384],[-2.308649,-6.305384],[-2.836304,-6.292061],[-3.042318,-6.250359],[-3.08485,-5.929559],[-3.097343,-4.969701],[-3.097343,-3.744068],[-2.545947,-3.306626],[-2.168178,-3.017178],[-1.859708,-2.84669],[-1.452401,-2.726998],[-0.778123,-2.589939],[0.004976,-2.437217],[0.872631,-2.609067],[1.917498,-2.871473],[2.542434,-3.326],[3.046414,-3.782054],[3.092988,-4.985319],[3.079744,-5.913375],[3.021605,-6.203472],[2.967147,-6.26045],[2.866364,-6.290921],[2.287937,-6.305384],[1.625651,-6.305384],[1.625651,-6.662321],[1.625651,-7.019258],[1.86918,-7.259764],[2.112712,-7.500269],[4.242139,-7.487469],[6.37157,-7.474669],[6.623768,-7.354861],[6.851504,-7.221852],[7.051168,-7.053764],[7.219257,-6.8541],[7.352265,-6.626364],[7.472074,-6.374165],[7.485715,-4.268398],[7.499356,-2.162631],[7.234953,-1.895438],[6.970546,-1.628245],[6.636669,-1.628245],[6.302788,-1.628245],[6.302788,-2.286025],[6.288541,-2.84494],[6.218933,-3.019695],[6.135315,-3.059624],[5.944202,-3.082592],[4.936207,-3.095583],[3.737332,-3.095583],[3.323381,-2.580027],[2.839428,-1.916953],[2.591335,-0.884925],[2.413246,-0.000418],[2.591213,0.883833],[2.839641,1.915555],[3.263184,2.498966],[3.724281,3.03743],[4.040222,3.081987],[4.958851,3.094748],[5.783644,3.091643],[6.024501,3.069581],[6.177311,3.017686],[6.26181,2.923838],[6.297732,2.775916],[6.302788,2.269371],[6.302788,1.62741],[6.659727,1.62741],[7.016663,1.62741],[7.255833,1.869588],[7.494999,2.111764],[7.49446,4.127912],[7.460688,6.126564],[7.394363,6.520363],[7.273079,6.773397],[6.975712,7.11631],[6.600848,7.368399],[6.43329,7.429193],[6.12798,7.462009],[4.242568,7.487051],[2.113563,7.500269],[1.869608,7.259346],[1.625656,7.018424],[1.625656,6.661486],[1.625656,6.304549],[2.287942,6.304549],[2.866369,6.290086],[2.967152,6.259615],[3.021611,6.202637],[3.079257,5.912405],[3.089771,4.976035],[3.05538,3.774274],[2.514928,3.294873],[1.861984,2.833186],[0.932159,2.612949],[-0.006129,2.452788],[-1.027756,2.631423],[-1.585179,2.749835],[-1.92852,2.862122],[-2.227105,3.04655],[-2.650257,3.381385],[-3.097336,3.741215],[-3.097336,4.950826],[-3.084507,5.9579],[-3.062637,6.152173],[-3.02528,6.232493],[-2.839,6.290588],[-2.291611,6.304549],[-1.629999,6.304549],[-1.629999,6.638428],[-1.629999,6.972307],[-1.894991,7.234534],[-2.159982,7.496761],[-4.222096,7.495675],[-6.052628,7.481231],[-6.358366,7.449821] ]);

	// Testing dimensions for debug
	//profile = profile.scale(1);
	
	var drill = CAG.circle({center: [0,0], radius: Dhole/2, resolution: quality});
	// Make a drill	
	w.push( drill );
	
	return	[ 	color([0,0.65,1],
					linear_extrude({height: extrusionlength},
						profile.subtract(w)
					)
				)
	];
	
} 